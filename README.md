# Домашнее задание: Celery

Оригинальное задание Netology: [Celery](https://github.com/netology-code/py-homeworks-web/tree/new/celery)

## Описание задания

Разработка API-сервиса для апскейлинга изображений с использованием Flask, Celery и ИИ-модели. Сервис предоставляет эндпоинты для загрузки изображений, проверки статуса обработки и получения обработанных файлов. Включает докеризацию и написание тестов.

## Мое решение

Проект представляет собой API-сервис для увеличения разрешения изображений (апскейлинга).

**Архитектура:**
*   **Flask:** Используется для создания RESTful API.
*   **Celery:** Система очередей задач для асинхронной обработки изображений.
*   **Redis:** Брокер сообщений для Celery.
*   **ИИ-модель:** Используется предобученная модель `EDSR_x2.pb` для апскейлинга.

**Основные функции:**
*   **Загрузка изображений:** Пользователи могут отправлять изображения через POST-запрос.
*   **Асинхронная обработка:** Задачи апскейлинга выполняются в фоновом режиме с помощью Celery.
*   **Проверка статуса:** Предоставляется эндпоинт для отслеживания статуса обработки изображений.
*   **Получение результатов:** Обработанные изображения доступны для скачивания.
*   **Докеризация:** Приложение упаковано в Docker-контейнеры для легкого развертывания.
*   **Тестирование:** Включены юнит-тесты для проверки основных компонентов.

**Используемые технологии:**
*   Python 3.9
*   Flask
*   Celery
*   Redis
*   Pillow, NumPy, OpenCV, TensorFlow (для обработки изображений и ИИ)
*   Gunicorn (WSGI HTTP Server)
*   Docker, Docker Compose

## Структура проекта

```
.
├── Dockerfile                  # Определение Docker-образа для приложения
├── EDSR_x2.pb                  # Предварительно обученная модель для апскейлинга изображений
├── README.md                   # Описание проекта и инструкции
├── app/                        # Основное Flask-приложение и логика
│   ├── __init__.py             # Инициализация пакета Python
│   ├── main.py                 # Основной файл Flask-приложения, определение роутов
│   ├── tasks.py                # Определение Celery-задач для фоновой обработки
│   └── upscale.py              # Логика апскейлинга изображений
├── docker-compose.yml          # Конфигурация Docker Compose для запуска сервисов (web, worker, redis)
├── lama_300px.png              # Пример изображения для тестирования
├── requirements.txt            # Список зависимостей Python
└── test_app.py                 # Юнит-тесты для приложения
```

## Инструкции по запуску

Для запуска проекта убедитесь, что у вас установлен Docker и Docker Compose.

1.  **Клонируйте репозиторий:**
    ```bash
    git clone https://github.com/YOUR_USERNAME/celery.git
    cd celery/upscale
    ```

2.  **Запустите сервисы с помощью Docker Compose:**
    ```bash
    docker compose up --build
    ```

3.  **Доступ к API:**
    *   Flask-приложение будет доступно по адресу `http://localhost:5000`.
    *   Redis будет доступен на порту `6379`.

4.  **Запуск тестов:**
    Для запуска тестов внутри контейнера `web`:
    ```bash
    docker compose exec web python test_app.py
    ```
    Или, если вы хотите запустить тесты локально (убедитесь, что у вас установлены зависимости из `requirements.txt`):
    ```bash
    pip install -r requirements.txt
    python test_app.py
    ```